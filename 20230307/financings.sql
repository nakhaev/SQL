ALTER TABLE [ods].[Financings] NOCHECK CONSTRAINT ALL;
SET IDENTITY_INSERT [BCIQ_ODS].[ods].[Financings] ON;
INSERT INTO [BCIQ_ODS].[ods].[Financings] (
  [Code]
       ,[Name]
      ,[FinancingUuid]
      ,[ReceivingCompany_Code]
      ,[ReceivingCompany_Name]
      ,[FinancingType_Code]
      ,[FinancingType_Name]
      ,[Currency_Code]
      ,[Currency_Name]
      ,[DateFiled]
      ,[DateCompleted]
      ,[AmountRaised]
      ,[SharesProposed]
      ,[PriceRange]
      ,[PriceRangeLow]
      ,[PriceRangeHigh]
      ,[FilingPrice]
      ,[SharesSold]
      ,[SharesOutstanding]
      ,[Rate]
      ,[YearEndingPrice]
      ,[CompletedComments]
      ,[SharePrice]
      ,[Notes]
      ,[OverAllotment]
      ,[PricePrior]
      ,[SharesAfterOffering]
      ,[SharesPriorOffering]
      ,[MarketCap]
      ,[CompletedStatus_Code]
      ,[CompletedStatus_Name]
      ,[FinancingID]
      ,[PhaseAtFinancing_Code]
      ,[PhaseAtFinancing_Name]
      ,[CreatedUser]
      ,[UpdatedUser]
      ,[CreatedDateTime]
      ,[UpdatedDateTime]
      ,[SharePriceOrigCurrency]
      ,[Updated_At]
      ,[Source]
      ,[InternalNotes]
      ,[PricePerShareOrigCurrency]
      ,[Deleted]
      ,[PostedFinancingCode]
      ,[ProposedAmount]
      ,[Agents]
      ,[AmountRaisedOrigCurr]
      ,[ProposedAmountOrigCurr]
      ,[Created_At]
      ,[Qacompleted]
      ,[ReadyForQa]
      ,[Posted]
) (
    SELECT 
        [odsCode] as Code
       ,[Name]
      ,[FinancingUuid]
      ,[ReceivingCompany_Code]
      ,[ReceivingCompany_Name]
      ,[FinancingType_Code]
      ,[FinancingType_Name]
      ,[Currency_Code]
      ,[Currency_Name]
      ,[DateFiled]
      ,[DateCompleted]
      ,[AmountRaised]
      ,[SharesProposed]
      ,[PriceRange]
      ,[PriceRangeLow]
      ,[PriceRangeHigh]
      ,[FilingPrice]
      ,[SharesSold]
      ,[SharesOutstanding]
      ,[Rate]
      ,[YearEndingPrice]
      ,[CompletedComments]
      ,[SharePrice]
      ,[Notes]
      ,[OverAllotment]
      ,[PricePrior]
      ,[SharesAfterOffering]
      ,[SharesPriorOffering]
      ,[MarketCap]
      ,[CompletedStatus_Code]
      ,[CompletedStatus_Name]
      ,[FinancingID]
      ,[PhaseAtFinancing_Code]
      ,[PhaseAtFinancing_Name]
      ,[CreatedUser]
      ,[UpdatedUser]
      ,[CreatedDateTime]
      ,[UpdatedDateTime]
      ,[SharePriceOrigCurr] as SharePriceOrigCurrency
      ,[Updated_At]
      ,[Source]
      ,[InternalNotes]
      ,[PricePerShareOrigCurrency]
      ,[Deleted]
      ,[PostedFinancingCode]      
      ,[ProposedAmount]      
      ,[Agents]
      ,[AmountRaisedOrigCurr]
      ,[ProposedAmountOrigCurr]
      ,[Created_At]
      ,[QACompleted]
      ,[ReadyForQA] 
      ,0
  FROM [BCIQ_ODS].[api].[Financings_Temp] WHERE Code != 9999
)
SET IDENTITY_INSERT [BCIQ_ODS].[ods].[Financings] OFF;
ALTER TABLE [ods].[Financings] CHECK CONSTRAINT ALL;